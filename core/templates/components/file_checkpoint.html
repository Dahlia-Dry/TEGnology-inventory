{% load tags %}
{% if file_obj is not None %}
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-2">
        <h1 class="h2">{{filetype|as_title}}</h1>
            <div class="btn-toolbar" role="toolbar">
                <div class="btn-group px-1">
                    <a href="/orders/{{selected_order.pipedrive_id}}/{{filetype}}" target="_blank"><button type="button" class="btn btn-sm btn-outline-secondary"><span data-feather="eye"></span> View File</button></a>
                </div>
                <div class="btn-group px-1">
                    <form method="POST">
                        {% csrf_token %}
                        <input type="hidden" name="form_id" value="delete_file">
                        <input type="hidden" name="filetype" value="{{filetype}}">
                        <input type="hidden" name ="pk" id="pk" value="{{selected_order.pipedrive_id}}">
                        <button type="submit" class="btn btn-sm btn-outline-danger"><span data-feather="trash"></span> Delete file</button>
                    </form>
                </div>
            </div>
    </div>
    {% if file_obj.sent_date is None %}
    <form method="POST">
        {% csrf_token %}
        <input type="hidden" name="form_id" value="set_date">
        <input type="hidden" name="filetype" value="{{filetype}}">
        <input type="hidden" name ="pk" id="pk" value="{{selected_order.pipedrive_id}}">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-2 border-bottom">
            {% with forms=file_form|key:filetype %}
            {{forms.date.as_p}}
            {% endwith %}
            <div class="btn-toolbar" role="toolbar">
                <div class="btn-group px-1">
                    <button type="submit" class="btn btn-sm btn-outline-success"><span data-feather="send"></span> Mark as Sent</button>
                </div>
            </div>
        </div>
    </form>
    {% else %}
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-2 border-bottom">
        <h4 class="h6" id="order-status">sent date: {{file_obj.sent_date}}</h4>
        <div class=class="btn-toolbar" role="toolbar">
            <form method="POST">
                {% csrf_token %}
                <input type="hidden" name="form_id" value="undo_set_date">
                <input type="hidden" name="filetype" value="{{filetype}}">
                <input type="hidden" name ="pk" id="pk" value="{{selected_order.pipedrive_id}}">
                <div class="btn-group px-1">
                    <button type="submit" class="btn btn-sm btn-outline-secondary"><span data-feather="rotate-ccw"></span> Undo Mark as Sent</button>
                </div>
            </form>
        </div>
    </div>
    {% endif %}
    {% else %}
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-3">
        <h1 class="h2">{{filetype|as_title}}</h1>
        <div class="btn-toolbar" role="toolbar">
            <div class="btn-group px-1">
                <a href="/orders/{{selected_order.pipedrive_id}}/{{filetype}}/generate"><button type="button" class="btn btn-sm btn-outline-secondary"><span data-feather="file-plus"></span> Generate</button></a>
            </div>
            <div class="btn-group px-1">
                <a class='upload-file' id='upload-file' name={{filetype}} href="/orders/{{selected_order.pipedrive_id}}/{{filetype}}/upload" data-popup-url="/orders/{{selected_order.pipedrive_id}}/{{filetype}}/upload"><button type="button" class="btn btn-sm btn-outline-secondary"><span data-feather="upload"></span> Upload</button></a>
            </div>
            <div class="modal fade" id="upload{{filetype}}Modal" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                    <form method="post" class="modal-content" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="modal-header">
                            <h5 class="modal-title">Upload {{filetype|as_title}} File</h5>
                            </div>
                        <input type="hidden" name="form_id" value="upload_file">
                        <input type="hidden" name="filetype" value="{{filetype}}">
                        <input type="hidden" name ="pk" id="pk" value="{{selected_order.pipedrive_id}}">
                        <div class="modal-body"></div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-sm btn-outline-success">Save</button>
                        </div>
                    </form>
                    </div>
            </div>
            </div>
        </div>
    </div>
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-3 border-bottom">
    </div>
{% endif %}